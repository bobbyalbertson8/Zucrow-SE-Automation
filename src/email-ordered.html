<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Purchase Order Placed</title>
  </head>
  <body style="margin:0;padding:0;background:#f8fafc;font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;">
    
    <!-- Email Container -->
    <div style="max-width:650px; margin:0 auto; background:#ffffff;">
      
      <!-- Header Section with Logos -->
      <? if (logos && logos.length) { ?>
        <div style="background: linear-gradient(135deg, #059669 0%, #10b981 50%, #34d399 100%); padding:30px 40px; text-align:center;">
          <div style="display:inline-block;">
            <? logos.forEach(function(logo, index){ ?>
              <img src="<?= logo.url ?>" 
                   alt="<?= logo.alt ?>" 
                   style="max-height:80px; height:auto; max-width:<?= logo.maxW ?>; <?= index > 0 ? 'margin-left:30px;' : '' ?> vertical-align:middle; border-radius:8px; box-shadow:0 4px 12px rgba(0,0,0,0.15);" 
                   onerror="this.style.display='none'"/>
            <? }); ?>
          </div>
        </div>
      <? } ?>

      <!-- Main Content Area -->
      <div style="padding:50px 40px;">
        
        <!-- Title Section -->
        <div style="text-align:center; margin-bottom:40px;">
          <h1 style="margin:0 0 12px; font-size:32px; font-weight:700; color:#1f2937; letter-spacing:-0.5px;">
            ‚úÖ Purchase Order Confirmed
          </h1>
          <div style="width:60px; height:4px; background:linear-gradient(90deg, #10b981, #3b82f6); margin:0 auto; border-radius:2px;"></div>
        </div>

        <!-- Greeting -->
        <div style="margin-bottom:35px;">
          <p style="font-size:18px; color:#374151; margin:0; line-height:1.6;">
            <? if (data.name) { ?>Hello <strong><?= data.name ?></strong>,<? } else { ?>Hello,<? } ?>
          </p>
        </div>

        <!-- Status Card -->
        <div style="background:linear-gradient(135deg, #ecfdf5 0%, #f0fdf4 100%); border:2px solid #10b981; border-radius:16px; padding:25px; margin-bottom:40px; position:relative; overflow:hidden;">
          <div style="position:absolute; top:0; right:0; width:100px; height:100px; background:rgba(16,185,129,0.1); border-radius:50%; transform:translate(30px, -30px);"></div>
          <div style="display:flex; align-items:center; position:relative;">
            <div style="width:50px; height:50px; background:#10b981; border-radius:50%; display:flex; align-items:center; justify-content:center; margin-right:20px; flex-shrink:0;">
              <span style="color:white; font-size:24px; font-weight:bold;">‚úì</span>
            </div>
            <div>
              <h3 style="margin:0 0 5px; font-size:20px; font-weight:600; color:#065f46;">Order Confirmed & Placed</h3>
              <p style="margin:0; font-size:16px; color:#047857;"><?= enhancedData.statusMessage ?></p>
            </div>
          </div>
        </div>

        <!-- Enhanced Order Details Card -->
        <div style="background:#ffffff; border:1px solid #e5e7eb; border-radius:16px; overflow:hidden; margin-bottom:40px; box-shadow:0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);">
          
          <!-- Card Header -->
          <div style="background:linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); padding:20px 30px; border-bottom:1px solid #e2e8f0;">
            <h2 style="margin:0; font-size:20px; font-weight:600; color:#1e293b; display:flex; align-items:center;">
              <span style="width:24px; height:24px; background:#10b981; border-radius:6px; display:inline-flex; align-items:center; justify-content:center; margin-right:12px;">
                <span style="color:white; font-size:14px;">üìã</span>
              </span>
              Order Details
            </h2>
          </div>

          <!-- Details Table -->
          <div style="padding:0;">
            <table role="presentation" cellpadding="0" cellspacing="0" border="0" style="width:100%; border-collapse:collapse;">
              
              <? if (data.poNumber) { ?>
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  PO Number
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b;">
                  <div style="background:#f1f5f9; padding:8px 16px; border-radius:8px; font-family:monospace; font-size:16px; font-weight:600; display:inline-block;">
                    <?= data.poNumber ?>
                  </div>
                </td>
              </tr>
              <? } ?>
              
              <!-- Enhanced Description Display -->
              <? if (data.description || data.item) { ?>
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Description
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b; line-height:1.6;">
                  <div style="background:#f8fafc; padding:15px 20px; border-radius:8px; border-left:4px solid #10b981;">
                    <strong style="display:block; color:#065f46; margin-bottom:5px;">Item Details:</strong>
                    <?= data.description || data.item ?>
                  </div>
                  <? if (enhancedData.hasLongDescription) { ?>
                    <div style="margin-top:10px; padding:10px; background:#ecfdf5; border-radius:6px; font-size:14px; color:#047857;">
                      üìù Detailed specifications included in your purchase request
                    </div>
                  <? } ?>
                </td>
              </tr>
              <? } ?>
              
              <? if (data.quantity) { ?>
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Quantity
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b;">
                  <strong style="font-size:18px; color:#059669;"><?= data.quantity ?></strong>
                </td>
              </tr>
              <? } ?>
              
              <? if (data.cost) { ?>
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Total Cost
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b;">
                  <div style="background:linear-gradient(135deg, #fee2e2 0%, #fef2f2 100%); color:#991b1b; padding:12px 20px; border-radius:10px; font-size:20px; font-weight:700; display:inline-block; border:1px solid #fecaca;">
                    <?= enhancedData.formattedCost || data.cost ?>
                  </div>
                  <? if (enhancedData.isUrgent) { ?>
                    <div style="margin-top:8px; padding:6px 12px; background:#fef3c7; color:#92400e; border-radius:4px; font-size:12px; font-weight:600; display:inline-block;">
                      üö® High-Value Order
                    </div>
                  <? } ?>
                </td>
              </tr>
              <? } ?>

              <? if (data.quotePdf) { ?>
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Quote/Documentation
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b;">
                  <a href="<?= data.quotePdf ?>" 
                     style="background:linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); color:white; padding:12px 24px; border-radius:8px; text-decoration:none; font-weight:600; display:inline-flex; align-items:center;">
                    üìÑ View Quote Document
                  </a>
                </td>
              </tr>
              <? } ?>

              <!-- Enhanced Tracking Information -->
              <? if (enhancedData.hasTracking) { ?>
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Tracking Reference
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b;">
                  <div style="background:#e0f2fe; padding:10px 16px; border-radius:8px; font-family:monospace; font-weight:600; color:#0369a1; display:inline-block;">
                    üîç <?= enhancedData.trackingInfo ?>
                  </div>
                </td>
              </tr>
              <? } ?>
              
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Current Status
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b;">
                  <span style="background:linear-gradient(135deg, #dcfce7 0%, #f0fdf4 100%); color:#166534; padding:8px 16px; border-radius:20px; font-size:14px; font-weight:600; border:1px solid #bbf7d0;">
                    <?= enhancedData.statusIcon ?> <?= data.status ?> - Order Confirmed
                  </span>
                </td>
              </tr>
              
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Estimated Delivery
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b;">
                  <div style="display:flex; align-items:center;">
                    <span style="font-weight:600; color:#059669; margin-right:10px;">üìÖ</span>
                    <span><?= enhancedData.estimatedDelivery ?></span>
                  </div>
                </td>
              </tr>
              
              <tr>
                <td style="padding:20px 30px; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Order Confirmed
                </td>
                <td style="padding:20px 30px; color:#1e293b;">
                  <?= enhancedData.formattedDate || data.timestamp ?>
                </td>
              </tr>
            </table>
          </div>
        </div>

        <!-- Next Steps Section -->
        <div style="background:linear-gradient(135deg, #fefce8 0%, #fef9c3 100%); border:1px solid #facc15; border-radius:16px; padding:30px; margin-bottom:40px;">
          <div style="display:flex; align-items:flex-start;">
            <div style="width:48px; height:48px; background:#eab308; border-radius:12px; display:flex; align-items:center; justify-content:center; margin-right:20px; flex-shrink:0;">
              <span style="color:white; font-size:20px;">üöÄ</span>
            </div>
            <div>
              <h3 style="margin:0 0 12px; font-size:18px; font-weight:600; color:#92400e;">What Happens Next?</h3>
              <p style="margin:0 0 15px; color:#a16207; line-height:1.6;">
                Your purchase request has been approved and the order has been placed with our supplier. Here's what you can expect:
              </p>
              <ul style="margin:0; padding-left:20px; color:#a16207; line-height:1.8;">
                <li><strong>Processing</strong> - Your order is being prepared by the vendor</li>
                <li><strong>Shipping Updates</strong> - You'll receive an "In Transit" notification when shipped</li>
                <li><strong>Delivery Confirmation</strong> - Final notification when your order arrives</li>
                <li><strong>Questions?</strong> - Reply to this email for immediate assistance</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Contact Information -->
        <div style="text-align:center; padding:30px 0; border-top:1px solid #e5e7eb;">
          <h3 style="margin:0 0 15px; font-size:18px; font-weight:600; color:#374151;">Questions about your order?</h3>
          <p style="margin:0 0 20px; color:#6b7280; line-height:1.6;">
            Our team is here to help throughout the entire process.
          </p>
          <div style="display:inline-flex; align-items:center; background:#f8fafc; padding:15px 25px; border-radius:12px; border:1px solid #e2e8f0;">
            <span style="color:#10b981; font-size:18px; margin-right:10px;">üìß</span>
            <span style="color:#374151; font-weight:500;">Reply to this email for support</span>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <div style="background:#f8fafc; padding:40px; text-align:center; border-top:1px solid #e5e7eb;">
        <p style="margin:0 0 8px; color:#6b7280; font-size:14px; font-weight:500;">
          Thank you for choosing us for your procurement needs
        </p>
        <p style="margin:0 0 15px; color:#9ca3af; font-size:12px;">
          Order Reference: Row <?= data.rowNumber ?> | Confirmed: <?= enhancedData.formattedDate || data.timestamp ?>
        </p>
        <div style="width:100%; height:1px; background:linear-gradient(90deg, transparent, #d1d5db, transparent); margin:20px 0;"></div>
        <p style="margin:0; font-size:11px; color:#d1d5db;">
          This confirmation was generated automatically by our purchase order system
        </p>
      </div>
    </div>
  </body>
</html>
