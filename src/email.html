<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Purchase Order Placed</title>
    <!--[if mso]>
    <noscript>
      <xml>
        <o:OfficeDocumentSettings>
          <o:PixelsPerInch>96</o:PixelsPerInch>
        </o:OfficeDocumentSettings>
      </xml>
    </noscript>
    <![endif]-->
  </head>
  <body style="margin:0;padding:0;background:#f8fafc;font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;">
    
    <!-- Email Container -->
    <div style="max-width:650px; margin:0 auto; background:#ffffff;">
      
      <!-- Header Section with Logos -->
      <? if (logos && logos.length) { ?>
        <div style="background: linear-gradient(135deg, #1e40af 0%, #3b82f6 50%, #60a5fa 100%); padding:30px 40px; text-align:center;">
          <div style="display:inline-block;">
            <? logos.forEach(function(logo, index){ ?>
              <img src="<?= logo.url ?>" 
                   alt="<?= logo.alt ?>" 
                   style="max-height:80px; height:auto; max-width:<?= logo.maxW ?>; <?= index > 0 ? 'margin-left:30px;' : '' ?> vertical-align:middle; border-radius:8px; box-shadow:0 4px 12px rgba(0,0,0,0.15);" 
                   onerror="this.style.display='none'"/>
            <? }); ?>
          </div>
        </div>
      <? } ?>

      <!-- Main Content Area -->
      <div style="padding:50px 40px;">
        
        <!-- Title Section -->
        <div style="text-align:center; margin-bottom:40px;">
          <h1 style="margin:0 0 12px; font-size:32px; font-weight:700; color:#1f2937; letter-spacing:-0.5px;">
            Purchase Order Placed
          </h1>
          <div style="width:60px; height:4px; background:linear-gradient(90deg, #3b82f6, #8b5cf6); margin:0 auto; border-radius:2px;"></div>
        </div>

        <!-- Greeting -->
        <div style="margin-bottom:35px;">
          <p style="font-size:18px; color:#374151; margin:0; line-height:1.6;">
            <? if (data.name) { ?>Hello <strong><?= data.name ?></strong>,<? } else { ?>Hello,<? } ?>
          </p>
        </div>

        <!-- Status Card -->
        <div style="background:linear-gradient(135deg, #ecfdf5 0%, #f0fdf4 100%); border:2px solid #10b981; border-radius:16px; padding:25px; margin-bottom:40px; position:relative; overflow:hidden;">
          <div style="position:absolute; top:0; right:0; width:100px; height:100px; background:rgba(16,185,129,0.1); border-radius:50%; transform:translate(30px, -30px);"></div>
          <div style="display:flex; align-items:center; position:relative;">
            <div style="width:50px; height:50px; background:#10b981; border-radius:50%; display:flex; align-items:center; justify-content:center; margin-right:20px; flex-shrink:0;">
              <span style="color:white; font-size:24px; font-weight:bold;">âœ“</span>
            </div>
            <div>
              <h3 style="margin:0 0 5px; font-size:20px; font-weight:600; color:#065f46;">Order Confirmed</h3>
              <p style="margin:0; font-size:16px; color:#047857;">Your purchase request has been ordered and is being processed.</p>
            </div>
          </div>
        </div>

        <!-- Order Details Card -->
        <div style="background:#ffffff; border:1px solid #e5e7eb; border-radius:16px; overflow:hidden; margin-bottom:40px; box-shadow:0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);">
          
          <!-- Card Header -->
          <div style="background:linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); padding:20px 30px; border-bottom:1px solid #e2e8f0;">
            <h2 style="margin:0; font-size:20px; font-weight:600; color:#1e293b; display:flex; align-items:center;">
              <span style="width:24px; height:24px; background:#3b82f6; border-radius:6px; display:inline-flex; align-items:center; justify-content:center; margin-right:12px;">
                <span style="color:white; font-size:14px;">ðŸ“‹</span>
              </span>
              Order Details
            </h2>
          </div>

          <!-- Details Table -->
          <div style="padding:0;">
            <table role="presentation" cellpadding="0" cellspacing="0" border="0" style="width:100%; border-collapse:collapse;">
              
              <? if (data.poNumber) { ?>
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  PO Number
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b;">
                  <div style="background:#f1f5f9; padding:8px 16px; border-radius:8px; font-family:monospace; font-size:16px; font-weight:600; display:inline-block;">
                    <?= data.poNumber ?>
                  </div>
                </td>
              </tr>
              <? } ?>
              
              <? if (data.item) { ?>
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Description
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b; line-height:1.6;">
                  <?= data.item ?>
                </td>
              </tr>
              <? } ?>
              
              <? if (data.quantity) { ?>
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Quantity
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b;">
                  <strong><?= data.quantity ?></strong>
                </td>
              </tr>
              <? } ?>
              
              <? if (data.cost) { ?>
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Total Cost
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b;">
                  <div style="background:linear-gradient(135deg, #fee2e2 0%, #fef2f2 100%); color:#991b1b; padding:10px 18px; border-radius:10px; font-size:18px; font-weight:700; display:inline-block; border:1px solid #fecaca;">
                    <?= data.cost ?>
                  </div>
                </td>
              </tr>
              <? } ?>

              <? if (data.quotePdf) { ?>
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Quote PDF
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b;">
                  <a href="<?= data.quotePdf ?>" 
                     style="background:linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); color:white; padding:10px 20px; border-radius:8px; text-decoration:none; font-weight:600; display:inline-flex; align-items:center;">
                    ðŸ“„ View Quote
                  </a>
                </td>
              </tr>
              <? } ?>
              
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Status
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b;">
                  <span style="background:linear-gradient(135deg, #dcfce7 0%, #f0fdf4 100%); color:#166534; padding:8px 16px; border-radius:20px; font-size:14px; font-weight:600; border:1px solid #bbf7d0;">
                    ðŸŸ¢ <?= data.status ?>
                  </span>
                </td>
              </tr>
              
              <tr>
                <td style="padding:20px 30px; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Order Date
                </td>
                <td style="padding:20px 30px; color:#1e293b;">
                  <?= data.timestamp ?>
                </td>
              </tr>
            </table>
          </div>
        </div>

        <!-- Next Steps Section -->
        <div style="background:linear-gradient(135deg, #fefce8 0%, #fef9c3 100%); border:1px solid #facc15; border-radius:16px; padding:30px; margin-bottom:40px;">
          <div style="display:flex; align-items:flex-start;">
            <div style="width:48px; height:48px; background:#eab308; border-radius:12px; display:flex; align-items:center; justify-content:center; margin-right:20px; flex-shrink:0;">
              <span style="color:white; font-size:20px;">ðŸš€</span>
            </div>
            <div>
              <h3 style="margin:0 0 12px; font-size:18px; font-weight:600; color:#92400e;">What's Next?</h3>
              <p style="margin:0 0 15px; color:#a16207; line-height:1.6;">
                We're processing your order and will keep you updated on the progress. You can expect:
              </p>
              <ul style="margin:0; padding-left:20px; color:#a16207; line-height:1.8;">
                <li><strong>Order confirmation</strong> - You'll receive tracking information once shipped</li>
                <li><strong>Delivery updates</strong> - Estimated delivery within 3-7 business days</li>
                <li><strong>Support</strong> - Reply to this email with any questions</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Contact Information -->
        <div style="text-align:center; padding:30px 0; border-top:1px solid #e5e7eb;">
          <h3 style="margin:0 0 15px; font-size:18px; font-weight:600; color:#374151;">Questions about your order?</h3>
          <p style="margin:0 0 20px; color:#6b7280; line-height:1.6;">
            Our team is here to help. Reply to this email or contact us directly.
          </p>
          <div style="display:inline-flex; align-items:center; background:#f8fafc; padding:15px 25px; border-radius:12px; border:1px solid #e2e8f0;">
            <span style="color:#3b82f6; font-size:18px; margin-right:10px;">ðŸ“§</span>
            <span style="color:#374151; font-weight:500;">Reply to this email for support</span>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <div style="background:#f8fafc; padding:40px; text-align:center; border-top:1px solid #e5e7eb;">
        <p style="margin:0 0 8px; color:#6b7280; font-size:14px; font-weight:500;">
          Thank you for choosing us for your procurement needs
        </p>
        <p style="margin:0 0 15px; color:#9ca3af; font-size:12px;">
          Order Reference: Row <?= data.rowNumber ?> | <?= data.timestamp ?>
        </p>
        <div style="width:100%; height:1px; background:linear-gradient(90deg, transparent, #d1d5db, transparent); margin:20px 0;"></div>
        <p style="margin:0; font-size:11px; color:#d1d5db;">
          This email was generated automatically by Google Apps Script
        </p>
      </div>
    </div>
  </body>
</html>
