<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Order Delivered Successfully</title>
  </head>
  <body style="margin:0;padding:0;background:#f8fafc;font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;">
    
    <!-- Email Container -->
    <div style="max-width:650px; margin:0 auto; background:#ffffff;">
      
      <!-- Header Section with Spectral Energies Logos -->
      <? if (logos && logos.length) { ?>
        <div style="background: linear-gradient(135deg, #1d4ed8 0%, #3b82f6 50%, #60a5fa 100%); padding:30px 40px; text-align:center;">
          <div style="display:inline-block;">
            <? logos.forEach(function(logo, index){ ?>
              <img src="<?= logo.url ?>" 
                   alt="<?= logo.alt ?>" 
                   style="max-height:80px; height:auto; max-width:<?= logo.maxW ?>; <?= index > 0 ? 'margin-left:30px;' : '' ?> vertical-align:middle; border-radius:8px; box-shadow:0 4px 12px rgba(0,0,0,0.15); background:white; padding:10px;" 
                   onerror="this.style.display='none'"/>
            <? }); ?>
          </div>
          <? if (logos.length > 1) { ?>
            <div style="color:white; font-size:14px; margin-top:15px; font-weight:500;">
              Spectral Energies & Purdue Propulsion Partnership
            </div>
          <? } else { ?>
            <div style="color:white; font-size:14px; margin-top:15px; font-weight:500;">
              Spectral Energies Delivery Confirmation
            </div>
          <? } ?>
        </div>
      <? } ?>

      <!-- Main Content Area -->
      <div style="padding:50px 40px;">
        
        <!-- Title Section -->
        <div style="text-align:center; margin-bottom:40px;">
          <h1 style="margin:0 0 12px; font-size:32px; font-weight:700; color:#1f2937; letter-spacing:-0.5px;">
            ðŸ“¦ Order Delivered Successfully!
          </h1>
          <div style="width:60px; height:4px; background:linear-gradient(90deg, #3b82f6, #10b981); margin:0 auto; border-radius:2px;"></div>
        </div>

        <!-- Greeting -->
        <div style="margin-bottom:35px;">
          <p style="font-size:18px; color:#374151; margin:0; line-height:1.6;">
            <? if (data.name) { ?>Hello <strong><?= data.name ?></strong>,<? } else { ?>Hello,<? } ?>
          </p>
        </div>

        <!-- Delivery Success Card -->
        <div style="background:linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border:2px solid #3b82f6; border-radius:16px; padding:25px; margin-bottom:40px; position:relative; overflow:hidden;">
          <div style="position:absolute; top:0; right:0; width:100px; height:100px; background:rgba(59,130,246,0.1); border-radius:50%; transform:translate(30px, -30px);"></div>
          <div style="display:flex; align-items:center; position:relative;">
            <div style="width:50px; height:50px; background:#3b82f6; border-radius:50%; display:flex; align-items:center; justify-content:center; margin-right:20px; flex-shrink:0;">
              <span style="color:white; font-size:24px; font-weight:bold;">ðŸ“¦</span>
            </div>
            <div>
              <h3 style="margin:0 0 5px; font-size:20px; font-weight:600; color:#1e40af;">Delivery Complete!</h3>
              <p style="margin:0; font-size:16px; color:#1d4ed8;"><?= enhancedData.statusMessage ?></p>
            </div>
          </div>
        </div>

        <!-- Complete Timeline -->
        <div style="background:#ffffff; border:1px solid #e5e7eb; border-radius:16px; overflow:hidden; margin-bottom:30px; box-shadow:0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);">
          <div style="background:linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); padding:20px 30px; border-bottom:1px solid #e2e8f0;">
            <h2 style="margin:0; font-size:20px; font-weight:600; color:#1e40af; display:flex; align-items:center;">
              <span style="width:24px; height:24px; background:#3b82f6; border-radius:6px; display:inline-flex; align-items:center; justify-content:center; margin-right:12px;">
                <span style="color:white; font-size:14px;">âœ…</span>
              </span>
              Order Journey Complete
            </h2>
          </div>
          
          <div style="padding:30px;">
            <!-- Complete Timeline -->
            <div style="position:relative; padding-left:40px;">
              <!-- Timeline Line -->
              <div style="position:absolute; left:15px; top:0; bottom:0; width:2px; background:#3b82f6;"></div>
              
              <!-- Step 1: Ordered (Complete) -->
              <div style="position:relative; margin-bottom:25px;">
                <div style="position:absolute; left:-27px; width:14px; height:14px; background:#10b981; border-radius:50%; border:3px solid #ffffff; box-shadow:0 0 0 2px #10b981;"></div>
                <div style="padding-left:5px;">
                  <h4 style="margin:0 0 3px; color:#065f46; font-weight:600;">âœ… Order Confirmed</h4>
                  <p style="margin:0; color:#6b7280; font-size:14px;">Purchase request approved and order placed</p>
                </div>
              </div>
              
              <!-- Step 2: In Transit (Complete) -->
              <div style="position:relative; margin-bottom:25px;">
                <div style="position:absolute; left:-27px; width:14px; height:14px; background:#f59e0b; border-radius:50%; border:3px solid #ffffff; box-shadow:0 0 0 2px #f59e0b;"></div>
                <div style="padding-left:5px;">
                  <h4 style="margin:0 0 3px; color:#92400e; font-weight:600;">ðŸšš In Transit</h4>
                  <p style="margin:0; color:#6b7280; font-size:14px;">Package shipped and tracked to destination</p>
                </div>
              </div>
              
              <!-- Step 3: Delivered (Complete) -->
              <div style="position:relative;">
                <div style="position:absolute; left:-27px; width:14px; height:14px; background:#3b82f6; border-radius:50%; border:3px solid #ffffff; box-shadow:0 0 0 2px #3b82f6;"></div>
                <div style="padding-left:5px;">
                  <h4 style="margin:0 0 3px; color:#1e40af; font-weight:600;">ðŸ“¦ Delivered</h4>
                  <p style="margin:0; color:#1d4ed8; font-size:14px; font-weight:500;">Successfully delivered and received!</p>
                  <p style="margin:5px 0 0; color:#6b7280; font-size:12px;">Completed: <?= enhancedData.formattedDate || data.timestamp ?></p>
                </div>
              </div>
            </div>
            
            <!-- Celebration Banner -->
            <div style="margin-top:30px; background:linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); padding:20px; border-radius:12px; border:1px solid #bbf7d0; text-align:center;">
              <div style="font-size:24px; margin-bottom:10px;">ðŸŽ‰</div>
              <p style="margin:0; color:#166534; font-weight:600; font-size:16px;">Order Successfully Completed!</p>
              <p style="margin:5px 0 0; color:#15803d; font-size:14px;">Your purchase request journey is now complete</p>
            </div>
          </div>
        </div>

        <!-- Final Order Summary -->
        <div style="background:#ffffff; border:1px solid #e5e7eb; border-radius:16px; overflow:hidden; margin-bottom:40px; box-shadow:0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);">
          
          <!-- Card Header -->
          <div style="background:linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); padding:20px 30px; border-bottom:1px solid #e2e8f0;">
            <h2 style="margin:0; font-size:20px; font-weight:600; color:#1e293b; display:flex; align-items:center;">
              <span style="width:24px; height:24px; background:#3b82f6; border-radius:6px; display:inline-flex; align-items:center; justify-content:center; margin-right:12px;">
                <span style="color:white; font-size:14px;">ðŸ“‹</span>
              </span>
              Final Order Summary
            </h2>
          </div>

          <!-- Details Table -->
          <div style="padding:0;">
            <table role="presentation" cellpadding="0" cellspacing="0" border="0" style="width:100%; border-collapse:collapse;">
              
              <? if (data.poNumber) { ?>
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  PO Number
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b;">
                  <div style="background:#f1f5f9; padding:8px 16px; border-radius:8px; font-family:monospace; font-size:16px; font-weight:600; display:inline-block;">
                    <?= data.poNumber ?>
                  </div>
                </td>
              </tr>
              <? } ?>
              
              <!-- Enhanced Description Display -->
              <? if (data.description || data.item) { ?>
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Item Delivered
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b; line-height:1.6;">
                  <div style="background:#eff6ff; padding:15px 20px; border-radius:8px; border-left:4px solid #3b82f6;">
                    <strong style="display:block; color:#1e40af; margin-bottom:5px;">ðŸ“¦ Successfully Delivered:</strong>
                    <?= data.description || data.item ?>
                  </div>
                  <div style="margin-top:10px; padding:8px 12px; background:#f0fdf4; border-radius:6px; font-size:12px; color:#166534; text-align:center;">
                    âœ… Item received and delivery confirmed
                  </div>
                </td>
              </tr>
              <? } ?>
              
              <? if (data.quantity) { ?>
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Quantity Delivered
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b;">
                  <strong style="font-size:18px; color:#1d4ed8;"><?= data.quantity ?> units âœ…</strong>
                </td>
              </tr>
              <? } ?>

              <? if (data.cost) { ?>
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Final Cost
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b;">
                  <div style="background:linear-gradient(135deg, #ecfdf5 0%, #f0fdf4 100%); color:#166534; padding:12px 20px; border-radius:10px; font-size:20px; font-weight:700; display:inline-block; border:1px solid #bbf7d0;">
                    <?= enhancedData.formattedCost || data.cost ?>
                  </div>
                </td>
              </tr>
              <? } ?>

              <!-- Enhanced Tracking Information -->
              <? if (enhancedData.hasTracking) { ?>
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Final Reference
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b;">
                  <div style="background:#dbeafe; padding:12px 18px; border-radius:8px; font-family:monospace; font-weight:600; color:#1e40af; display:inline-block; border:1px solid #93c5fd;">
                    ðŸ“‹ <?= enhancedData.trackingInfo ?>
                  </div>
                  <p style="margin:8px 0 0; color:#6b7280; font-size:12px;">Reference for your records</p>
                </td>
              </tr>
              <? } ?>
              
              <tr>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Final Status
                </td>
                <td style="padding:20px 30px; border-bottom:1px solid #f1f5f9; color:#1e293b;">
                  <span style="background:linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); color:#1e40af; padding:8px 16px; border-radius:20px; font-size:14px; font-weight:600; border:1px solid #93c5fd;">
                    <?= enhancedData.statusIcon ?> <?= data.status ?> - Order Complete
                  </span>
                </td>
              </tr>
              
              <tr>
                <td style="padding:20px 30px; font-weight:600; color:#64748b; width:180px; vertical-align:top;">
                  Delivered On
                </td>
                <td style="padding:20px 30px; color:#1e293b;">
                  <div style="display:flex; align-items:center;">
                    <span style="font-weight:600; color:#3b82f6; margin-right:10px; font-size:18px;">ðŸ“…</span>
                    <span style="font-weight:600;"><?= enhancedData.formattedDate || data.timestamp ?></span>
                  </div>
                </td>
              </tr>
            </table>
          </div>
        </div>

        <!-- Thank You & Next Steps Section -->
        <div style="background:linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); border:1px solid #10b981; border-radius:16px; padding:30px; margin-bottom:40px;">
          <div style="display:flex; align-items:flex-start;">
            <div style="width:48px; height:48px; background:#059669; border-radius:12px; display:flex; align-items:center; justify-content:center; margin-right:20px; flex-shrink:0;">
              <span style="color:white; font-size:20px;">ðŸŽ‰</span>
            </div>
            <div>
              <h3 style="margin:0 0 12px; font-size:18px; font-weight:600; color:#065f46;">Thank You!</h3>
              <p style="margin:0 0 15px; color:#047857; line-height:1.6;">
                Your purchase request has been successfully completed from start to finish. We appreciate your trust in our procurement process:
              </p>
              <ul style="margin:0; padding-left:20px; color:#047857; line-height:1.8;">
                <li><strong>Order Fulfilled</strong> - Item delivered as requested</li>
                <li><strong>Process Complete</strong> - No further action required</li>
                <li><strong>Records Updated</strong> - All documentation finalized</li>
                <li><strong>Future Orders</strong> - Submit new requests anytime through the same process</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Contact Information -->
        <div style="text-align:center; padding:30px 0; border-top:1px solid #e5e7eb;">
          <h3 style="margin:0 0 15px; font-size:18px; font-weight:600; color:#374151;">Questions or feedback about your order?</h3>
          <p style="margin:0 0 20px; color:#6b7280; line-height:1.6;">
            We'd love to hear about your experience with our procurement process.
          </p>
          <div style="display:inline-flex; align-items:center; background:#f8fafc; padding:15px 25px; border-radius:12px; border:1px solid #e2e8f0;">
            <span style="color:#3b82f6; font-size:18px; margin-right:10px;">ðŸ“§</span>
            <span style="color:#374151; font-weight:500;">Reply to this email with feedback or questions</span>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <div style="background:#f8fafc; padding:40px; text-align:center; border-top:1px solid #e5e7eb;">
        <p style="margin:0 0 8px; color:#6b7280; font-size:14px; font-weight:500;">
          ðŸŽ‰ Order successfully completed - thank you for your business!
        </p>
        <p style="margin:0 0 15px; color:#9ca3af; font-size:12px;">
          Delivery Reference: Row <?= data.rowNumber ?> | Delivered: <?= enhancedData.formattedDate || data.timestamp ?>
        </p>
        <div style="width:100%; height:1px; background:linear-gradient(90deg, transparent, #d1d5db, transparent); margin:20px 0;"></div>
        <p style="margin:0; font-size:11px; color:#d1d5db;">
          This delivery confirmation was generated automatically by our order tracking system
        </p>
      </div>
    </div>
  </body>
</html>
